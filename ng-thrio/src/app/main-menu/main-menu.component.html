<header>
  <div class="top-left">
    <h1 routerLink="/" (click)="mode = 'menu'">THRIO<span>.app</span></h1>
    <a
      class="back-btn"
      (click)="mode = 'menu'"
      *ngIf="mode !== 'menu'"
      [@slideB]
    >
      <i class="fas fa-caret-left"></i>main menu</a
    >
  </div>

  <div
    class="top-right"
    (click)="mode = mode === 'settings' ? 'menu' : 'settings'"
  >
    <span> {{ authService.user?.displayName }} </span>
    <i class="fas fa-user-cog clickable"></i>
  </div>
</header>

<main [ngSwitch]="mode">
  <div *ngSwitchCase="'menu'" [@slideA] class="main-menu">
    <button (click)="mode = 'findGames'; getRooms()" [disabled]="searching">
      <i class="fas fa-circle-notch fa-spin" *ngIf="searching"></i>
      find a game
    </button>

    <p class="or">or</p>

    <div>
      <button (click)="mode = 'newRoom'">start new game</button>
    </div>
  </div>

  <div *ngSwitchCase="'newRoom'" [@slideB] class="menu-b">
    <h3>New Game</h3>
    <div>
      <label>Public</label>
      <br />
      <switch [(switch)]="config.public"></switch>
    </div>
    <!-- <br />
    <label>Size</label>
    <input type="range" min="2" max="5" value="3" class="slider"> -->

    <button (click)="newRoom()">Create room</button>
  </div>

  <div *ngSwitchCase="'findGames'" [@slideB] class="menu-b find-games">
    <h3>
      Public Games
      <i
        class="clickable fas fa-sync-alt"
        [class.fa-spin]="gettingRooms"
        (click)="getRooms()"
        *ngIf="gettingRooms || canGetRooms"
        [@slideB]
      ></i>
    </h3>

    <table>
      <tr
        *ngFor="let room of rooms"
        class="clickable"
        (click)="joinRoom(room.roomCode)"
        [@slideV]
      >
        <td>{{ room.roomCode }}</td>
        <td>{{ room.players.length }} / {{ room.config.players }}</td>
        <td>{{ room.timestamp | timeAgo }}</td>
      </tr>
    </table>


    <form (submit)="joinRoom()">
      <div class="field">
        <input
          type="text"
          [(ngModel)]="roomCode"
          name="roomCode"
          placeholder="Enter a room code"
          autocomplete="off"
          spellcheck="false"
        />
        <button
          action="submit"
          [disabled]="!roomCode || roomCode?.length !== 4"
        >
          Join Game
        </button>
      </div>
    </form>
  </div>

  <div *ngSwitchCase="'settings'" [@slideB] class="menu-b">
    <h3>Settings</h3>
    <div>
      <label class="db">Nickname</label>
      <input
        type="text"
        [(ngModel)]="name"
        name="name"
        (blur)="authService.changeName(name)"
      />
    </div>
  </div>
</main>

<footer>
  <a href="https://odedfalik.com" target="_blank">by oded</a>
</footer>
